<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>行軍タイミング計算</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      margin: 0;
      background-color: #f5f5f5;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      max-width: 600px;
      margin: auto;
      border-collapse: collapse;
    }

    th, td {
      padding: 8px;
      text-align: center;
    }

    input {
      width: 100%;
      box-sizing: border-box;
      padding: 6px;
    }

    button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }

    .result {
      margin-top: 20px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
    }

    .container {
      max-width: 600px;
      margin: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>行軍タイミング計算</h1>

    <table id="inputTable">
      <tr>
        <th>分</th>
        <th>秒</th>
      </tr>
      <tr>
        <td><input type="number" class="min" value="0"></td>
        <td><input type="number" class="sec" value="10"></td>
      </tr>
      <tr>
        <td><input type="number" class="min" value="0"></td>
        <td><input type="number" class="sec" value="20"></td>
      </tr>
    </table>

    <div style="text-align:center;">
      <button onclick="addRow()">＋行追加</button>
      <button onclick="calculate()">計算</button>
    </div>

    <div class="result" id="resultArea"></div>
  </div>

  <script>
    function addRow() {
      const table = document.getElementById("inputTable");
      const row = table.insertRow();
      const cellMin = row.insertCell();
      const cellSec = row.insertCell();

      const minInput = document.createElement("input");
      minInput.type = "number";
      minInput.className = "min";
      minInput.value = "0";

      const secInput = document.createElement("input");
      secInput.type = "number";
      secInput.className = "sec";
      secInput.value = "0";

      cellMin.appendChild(minInput);
      cellSec.appendChild(secInput);
    }

    function calculate() {
      const mins = document.querySelectorAll(".min");
      const secs = document.querySelectorAll(".sec");

      let x = [];
      for (let i = 0; i < mins.length; i++) {
        let totalSec = parseInt(mins[i].value || 0) * 60 + parseInt(secs[i].value || 0);
        x.push(totalSec);
      }

      const xAve = x.reduce((a, b) => a + b, 0) / x.length;
      const xA = xAve % 1;

      let y = x.map(xi => xA - (xi % 1));
      const yMin = Math.min(...y);
      const yA = Math.abs(yMin);

      const result = y.map(yi => Math.round((yA + yi) * 1000) / 1000); // 小数第3位まで

      document.getElementById("resultArea").innerHTML =
        result.map((r, i) => `${i + 1}人目： ${r} 秒後に出征`).join("<br>");
    }
  </script>
</body>
</html>
